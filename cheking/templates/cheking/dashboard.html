{% extends "base.html" %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">

{% block title %}Tableau de bord{% endblock %}

{% block content %}

<div class="container py-4 mb-5 border">
    <div class="row align-items-center mb-4">
        <div class="col-6 text-start text-muted">
            <i class="fas fa-calendar-alt"></i><small>SAMEDI 20 SEPTEMBRE 2025</small>
        </div>
        <div class="col-6 text-end text-muted">
            <i class="fas fa-ring" style="color: gold;"></i><small>MARIAGE : ROLLAND & TSIORY</small>
        </div>
    </div>

    <div class="row text-center mb-5">
        <div class="col-12">
            <div class="rounded-circle-progress" style="--progress: {{pourcentage_present}}%;">
                <div class="rounded-circle-progress-bar"></div>
                <div class="rounded-circle-progress-text">{{nombre_invite_present}}/{{ nombre_invite }}</div>
            </div>
            <p class="mt-2 text-muted">INVITÉS PRÉSENTS</p>
        </div>
    </div>

    <div class="row g-3 mb-4">
        <div class="col-6" id="guestCardhusband" data-url="{% url 'cheking:dashfilter' 'marie' %}">
            <div class="category-card shadow-sm border border-primary-subtle">
                <i class="fas fa-person text-primary"></i>
                <h6 class="mb-0">Invités du Mari</h6>
                <span>{{invite_marie_present}}/{{invite_marie}}</span>
            </div>
        </div>
        <div class="col-6" id="guestCardwife" data-url="{% url 'cheking:dashfilter' 'mariee' %}">
            <div class="category-card shadow-sm border border-warning-subtle">
                <i class="fas fa-person-dress text-warning"></i>
                <h6 class="mb-0">Invités de la Mariée</h6>
                <span>{{ invite_mariee }}/{{ invite_mariee }}</span>
            </div>
        </div>
        <div class="col-6" id="guestCardfriend" data-url="{% url 'cheking:dashfilter' 'amis - collegues' %}">
            <div class="category-card shadow-sm border border-success-subtle">
                <i class="fas fa-handshake text-success"></i>
                <h6 class="mb-0">Amis & Collègues</h6>
                <span>{{ invite_ami_present }}/{{ invite_ami }}</span>
            </div>
        </div>
        <div class="col-6" id="guestCardchurch" data-url="{% url 'cheking:dashfilter' 'eglise' %}">
            <div class="category-card shadow-sm border border-info-subtle">
                <i class="fas fa-church text-info"></i>
                <h6 class="mb-0">Église</h6>
                <span>{{ invite_eglise_present }}/{{ invite_eglise }}</span>
            </div>
        </div>
        <div class="col-12" id="guestCardstaff" data-url="{% url 'cheking:dashfilter' 'staff - logistics' %}">
            <div class="category-card shadow-sm border border-danger-subtle">
                <i class="fas fa-people-carry-box text-danger"></i>
                <h6 class="mb-0">Staff & Logistique</h6>
                <span>{{ invite_staff_present }}/{{ invite_staff }}</span>
            </div>
        </div>
    </div>

    <div class="row d-flex justify-content-center mt-4 mb-3">
        <div class="col-12 d-flex justify-content-evenly">
            <button type="button" class="btn btn-primary btn-lg rounded-pill" data-bs-toggle="modal" data-bs-target="#qrScannerModal">
                <i class="fas fa-qrcode me-2"></i>Scanner un QR Code
            </button>

            <div class="modal fade" id="qrScannerModal" tabindex="-1" aria-labelledby="qrScannerModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="qrScannerModalLabel">Scanner un code QR</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body text-center">
                            <div id="qr-reader" style="width: 100%;"></div>
                            <div id="result-container" class="mt-3" style="display:none;">
                                <p>Code scanné : <span id="scanned-code" class="fw-bold text-success"></span></p>
                                <a id="send-button" href="#" data-url="{% url 'cheking:process_qr' code='___' %}" class="btn btn-success mt-2">Envoyer</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                <a href="{% url 'cheking:search' %}" class="btn btn-outline-secondary btn-lg rounded-pill" style="min-width: 45%;">
                    <i class="fas fa-search me-2"></i>Rechercher un invité
                </a>
            </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}